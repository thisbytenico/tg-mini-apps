import{_ as e,E as t,ab as s,v as a,af as l,T as i,S as o,U as c,R as n,A as d,y as r,a6 as m,G as u,H as f,h as p,w as h,p as g,O as k,a4 as x,Y as w,ad as y,M as b,g as _,i as C,ai as U,I as S,l as M,k as T,r as j,F,J as L,t as I,ak as v}from"./index-BdsNz36l.js";import{_ as V}from"./u-button.Di26Z4V2.js";import{_ as D}from"./more.DkU1Ligo.js";import"./u-loading-icon.BXA7DYQS.js";const N=e({name:"",components:{},data:()=>({isShowMenu:!1,mode:"",selectList:[],dataList:[]}),created(){},watch:{},computed:{},methods:{lookVideo(e){t({url:"/pages/view/index?src="+encodeURIComponent(this.config().baseUrl+"/sofn-sys-web/sysTemplate/downPic?fileUrl="+e.resourceUrl)})},lookImage(e){s({urls:[this.config().baseUrl+"/sofn-sys-web/sysTemplate/downPic?fileUrl="+e.resourceUrl],current:0})},config:()=>a,actionSelect(e){const t=this.selectList.indexOf(e.id);-1===t?this.selectList.push(e.id):this.selectList.splice(t,1)},actionUploadVideo(){l({count:1,success:e=>{console.log(e),i({title:"上传中"}),o({url:a.baseUrl+"/sofn-tts-web-branch/ttsScltxxcjRegiter/upload?fileapi17268223914946",file:e.tempFile,header:{},formData:{_file:e.tempFile.name},success:async t=>{let s=JSON.parse(t.data);await this.addTtsScltxxcjMedia(e.tempFile.name,"video",s.path)},complete:e=>{c()}})}})},actionMultiDelete(){this.selectList=[],this.mode="delete"},actionUploadImage(){n({count:1,success:e=>{i({title:"上传中"}),o({url:a.baseUrl+"/sofn-tts-web-branch/ttsScltxxcjRegiter/upload?fileapi17268223914946",file:e.tempFiles[0],header:{},formData:{_file:e.tempFiles[0].name},success:async t=>{let s=JSON.parse(t.data);await this.addTtsScltxxcjMedia(e.tempFiles[0].name,"image",s.path)},complete:e=>{c()}})}})},addTtsScltxxcjMedia(e,t,s){let a={fileNames:e,types:t,urls:s,userId:d("userInfo").id},l="";for(const i in a)l+=i+"="+a[i]+"&";console.log(l),i({title:"添加资源中"}),r.post("sofn-tts-web-branch/ttsScltxxcjMedia/addTtsScltxxcjMedia?"+l,{},{header:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",token:d("token")},toast:!1}).then((e=>{this.$refs.paging.reload()})).finally((()=>{c()}))},actionConfrimDelete(){m({content:"确定删除所选资源？",success:e=>{if(e.confirm){i({title:"删除资源中"});let e="";this.selectList.forEach((t=>{e+="ids="+t+"&"})),r.post("sofn-tts-web-branch/ttsScltxxcjMedia/deleteTtsScltxxcjMedia?"+e,{},{header:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",token:d("token")},toast:!1}).then((e=>{this.mode="",this.$refs.paging.reload()})).finally((e=>{c()}))}}})},queryList(e,t){r.post("sofn-tts-web-branch/ttsScltxxcjMedia/getMediaPageInfo",{pageNum:e,pageSize:10,userId:d("userInfo").id},{header:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",token:d("token")},toast:!1}).then((e=>{this.$refs.paging.complete(e.data.list)}))},ajaxXxx(){}}},[["render",function(e,t,s,a,l,i){const o=L,c=g,n=u(f("dw-icon"),k),d=u(f("dw-cell"),x),r=u(f("u-navbar"),w),m=u(f("u-checkbox"),y),N=v,P=u(f("z-paging"),b),O=u(f("u-button"),V);return _(),p(c,{class:"cms"},{default:h((()=>[C(r,{title:"图片管理",autoBack:!0,placeholder:"",border:""},{right:h((()=>[C(c,{class:"u-nav-slot cms-nav-slot",onClick:t[2]||(t[2]=e=>l.isShowMenu=!0)},{default:h((()=>[C(o,{src:D,style:{width:"36rpx",height:"36rpx"}}),l.isShowMenu?(_(),p(c,{key:0,class:"cms-menu-mask",onClick:t[0]||(t[0]=U((e=>l.isShowMenu=!1),["stop"]))})):S("",!0),l.isShowMenu?(_(),p(c,{key:1,class:"cms-menu",onClick:t[1]||(t[1]=U((e=>l.isShowMenu=!1),["stop"]))},{default:h((()=>[C(d,{onClick:i.actionUploadImage},{prefix:h((()=>[C(n,{name:"filedone",style:{"margin-right":"-12rpx"}})])),default:h((()=>[M(" 上传图片 ")])),_:1},8,["onClick"]),C(d,{onClick:i.actionUploadVideo},{prefix:h((()=>[C(n,{name:"filedone",style:{"margin-right":"-12rpx"}})])),default:h((()=>[M(" 上传视频 ")])),_:1},8,["onClick"]),C(d,{onClick:i.actionMultiDelete},{prefix:h((()=>[C(n,{name:"filedone",style:{"margin-right":"-12rpx"}})])),default:h((()=>[M(" 批量删除 ")])),_:1},8,["onClick"])])),_:1})):S("",!0)])),_:1})])),_:1}),C(c,{class:"cms-body"},{default:h((()=>[C(P,{fixed:!1,ref:"paging",modelValue:l.dataList,"onUpdate:modelValue":t[3]||(t[3]=e=>l.dataList=e),onQuery:i.queryList},{default:h((()=>[C(c,{class:"cms-list"},{default:h((()=>[(_(!0),T(F,null,j(l.dataList,((e,t)=>(_(),p(c,{class:"cms-item",key:t,onClick:t=>i.actionSelect(e)},{default:h((()=>[C(c,{class:"cms-item-del"},{default:h((()=>["delete"===l.mode?(_(),p(c,{key:0,class:"cms-item-del-body"},{default:h((()=>[C(m,{checked:l.selectList.includes(e.id),shape:"circle",activeColor:"#00B568"},null,8,["checked"])])),_:2},1024)):S("",!0)])),_:2},1024),C(c,{class:"cms-item-del"}),C(c,{class:"cms-item-icon"},{default:h((()=>["image"==e.resourceType?(_(),p(o,{key:0,onClick:t=>i.lookImage(e),src:i.config().baseUrl+"/sofn-sys-web/sysTemplate/downPic?fileUrl="+e.resourceUrl,mode:"cover",style:{width:"100%",height:"100%"}},null,8,["onClick","src"])):S("",!0),C(c,{onClick:t=>i.lookVideo(e),style:{width:"100%",height:"100%"}},{default:h((()=>[C(N,{src:i.config().baseUrl+"/sofn-sys-web/sysTemplate/downPic?fileUrl="+e.resourceUrl,mode:"cover",style:{width:"100%",height:"100%","pointer-events":"none"}},null,8,["src"])])),_:2},1032,["onClick"])])),_:2},1024),C(c,{class:"cms-item-title"},{default:h((()=>[M(I(e.resourceName),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1},8,["modelValue","onQuery"])])),_:1}),"delete"===l.mode?(_(),p(c,{key:0,class:"cms-footer"},{default:h((()=>[C(O,{onClick:t[4]||(t[4]=e=>l.mode="")},{default:h((()=>[M("取消")])),_:1}),C(O,{style:{background:"#00B568",color:"#FFF"},onClick:i.actionConfrimDelete},{default:h((()=>[M("确认删除")])),_:1},8,["onClick"])])),_:1})):S("",!0)])),_:1})}],["__scopeId","data-v-df8d7071"]]);export{N as default};
