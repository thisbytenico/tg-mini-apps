import{_ as e,$ as t,Q as a,E as o,C as l,y as s,A as r,X as i,W as d,x as n,V as u,G as f,H as m,L as c,h,w as p,Y as y,p as b,a4 as _,O as g,g as C,i as x,l as V,I as U,K as N}from"./index-CBLTQg_b.js";import{_ as R}from"./dw-card.CeBHaIwR.js";import{_ as T}from"./u-button.D235zKSd.js";import"./u-loading-icon.Bdr6stTV.js";const k=e({name:"",components:{},data:()=>({isDefault:!0,unitList:[],form:{name:"",address:"",addressName:"",addressCode:"",area:"",longitude:"",latitude:"",manager:"",phone:"",dictName:"舍",status:"启用",picture:"",pictureTwo:""},fileList:[]}),onLoad(e){const{type:a,info:o}=e;this.type=a;try{let e=JSON.parse(decodeURIComponent(o));console.log(e),this.form.phone=e.PHONE,this.form.name=e.NAME,this.form.address=e.ADDRESS,this.form.addressName=e.ADDRESS_NAME,this.form.addressCode=e.ADDRESS_CODE,this.form.area=e.AREA,this.form.longitude=e.LONGITUDE,this.form.latitude=e.LATITUDE,this.form.manager=e.MANAGER,this.form.dictName=e.DICT_NAME,this.form.status="Y"===e.STATUS?"启用":"停用",this.form.id=e.ID,this.$nextTick((()=>{this.$refs.myLocationRef.modelValue=e.LATITUDE+"-"+e.LONGITUDE,this.$refs.myFileUploadRef.fileList=[{resourceUrl:e.PICTURE},{resourceUrl:e.PICTURE_TWO}].filter((e=>e.resourceUrl))}))}catch(l){}t("selectEmployee",(e=>{this.form.manager=e.STAFF_NAME,this.form.phone=e.PHONE})),this.initPage()},onUnload(){a("selectEmployee")},watch:{},computed:{},methods:{actionJumpTo(e){o({url:e})},statusConfirm(e){this.form.status="启用"===e?"Y":"N"},unitNameConfirm(e){this.form.dictName=e},actionSubmit(){var e,t;let a=this.$refs.myFileUploadRef.fileList.map((e=>e.resourceUrl));if(a[0]&&(this.form.picture=a[0]),a[1]&&(this.form.pictureTwo=a[1]),!this.form.addressCode&&!(null==(e=this.$refs.myCityRef.cacheValue[3])?void 0:e.code))return l("请选择所属区域");if(!this.$refs.myLocationRef.modelValue)return l("请选择经纬度");if(!this.form.name)return l("请输入名称");if(!this.form.address)return l("请输入基地详细地址");if(!this.form.area)return l("请输入基地面积");if(!this.form.manager)return l("请输入基地负责人");if(!this.form.phone)return l("请输入联系方式");if(11!=this.form.phone.length)return l("请输入正确的联系方式");this.form.latitude=this.$refs.myLocationRef.modelValue.split("-")[0],this.form.longitude=this.$refs.myLocationRef.modelValue.split("-")[1],(null==(t=this.$refs.myCityRef.cacheValue[3])?void 0:t.code)&&(this.form.addressCode=this.$refs.myCityRef.cacheValue[3].code),this.form.addressName=this.$refs.myCityRef.getContent;let o={...this.form};o.status="启用"===o.status?"Y":"N","add"===this.type?s.post("sofn-tts-web-branch/ttsScltxxcjBase/addTtsScltxxcjBase?id="+r("userInfo").id,{...o},{header:{token:r("token")},toast:!1}).then((e=>{200==e.httpCode?(l("添加成功"),i({delta:1}),d("baseRefresh")):l(e.msg)})):s.post("sofn-tts-web-branch/ttsScltxxcjBase/updateTtsScltxxcjBase?id="+r("userInfo").id,{...o},{header:{token:r("token")},toast:!1}).then((e=>{200==e.httpCode?(l("修改成功"),i({delta:1}),d("baseRefresh")):l(e.msg)})),n({title:"点击保存",duration:2e3})},actionDelete(e){this.fileList.splice(e.index,1),n({icon:"none",title:"删除图片"})},afterRead(){},initPage(){switch(this.type){case"add":this.pageTitle="新增基地";break;case"edit":this.pageTitle="编辑基地"}u({title:this.pageTitle}),this.getUnitList()},ajaxXxx(){},getUnitList(){s.get("sofn-tts-web-branch/ttsScltxxcjBase/getBaseUnit",{header:{token:r("token")},toast:!1}).then((e=>{200==e.httpCode?this.unitList=e.data.map((e=>e.dictName)):l(e.msg)}))}}},[["render",function(e,t,a,o,l,s){const r=f(m("u-navbar"),y),i=b,d=N,n=f(m("dw-cell"),_),u=f(m("dw-icon"),g),k=c("myCity"),L=c("myLocation"),E=c("myInputBox"),w=c("myFormItem"),S=c("mySelectBox"),A=c("myContent"),D=c("myFileUpload"),I=f(m("dw-card"),R),O=f(m("u-button"),T);return C(),h(i,{class:"base-edit"},{default:p((()=>[x(r,{title:e.pageTitle,autoBack:!0,placeholder:"",border:""},null,8,["title"]),x(i,{class:"base-edit-body"},{default:p((()=>[x(n,{"footer-border":!1,background:"transparent"},{footer:p((()=>[x(i,{class:"base-edit-input-group col1"},{default:p((()=>[x(i,{class:"base-edit-checkbox pl12 pr12"},{default:p((()=>[x(d,{modelValue:l.form.name,"onUpdate:modelValue":t[0]||(t[0]=e=>l.form.name=e),style:{width:"100%"},type:"text",placeholder:"请输入基地名称"},null,8,["modelValue"])])),_:1})])),_:1})])),default:p((()=>[x(i,null,{default:p((()=>[V("基地名称")])),_:1})])),_:1}),x(n,{"footer-border":!1,background:"transparent"},{footer:p((()=>[x(i,{class:"base-edit-input-group col1"},{default:p((()=>[x(i,{class:"base-edit-checkbox pl12 pr12"},{default:p((()=>[x(k,{defaultValue:l.form.addressName,ref:"myCityRef",title:"选择所属区域",placeholder:"请选择所属区域"},{icon:p((()=>[x(u,{name:"location-fill",color:"#2B8AF4"})])),_:1},8,["defaultValue"])])),_:1})])),_:1})])),default:p((()=>[x(i,null,{default:p((()=>[V("所属区域")])),_:1})])),_:1}),x(n,{"footer-border":!1,background:"transparent"},{footer:p((()=>[x(i,{class:"base-edit-input-group col1"},{default:p((()=>[x(i,{class:"base-edit-checkbox pl12 pr12"},{default:p((()=>[x(d,{modelValue:l.form.address,"onUpdate:modelValue":t[1]||(t[1]=e=>l.form.address=e),style:{width:"100%"},type:"text",placeholder:"请输入地址"},null,8,["modelValue"])])),_:1})])),_:1})])),default:p((()=>[x(i,null,{default:p((()=>[V("基地详细地址")])),_:1})])),_:1}),x(w,{label:"经纬度"},{default:p((()=>[x(E,null,{default:p((()=>[x(L,{keyword:l.form.address,ref:"myLocationRef",placeholder:"选择经纬度"},null,8,["keyword"])])),_:1})])),_:1}),x(w,{label:"基地面积/单位",col:"2"},{default:p((()=>[x(E,null,{default:p((()=>[x(d,{modelValue:l.form.area,"onUpdate:modelValue":t[2]||(t[2]=e=>l.form.area=e),style:{width:"100%"},type:"text",placeholder:"输入面积"},null,8,["modelValue"])])),_:1}),x(E,null,{default:p((()=>[l.unitList.length>0?(C(),h(S,{key:0,onOnConfirm:s.unitNameConfirm,placeholder:"请选择",title:"单位",modelValue:l.form.dictName,"onUpdate:modelValue":t[3]||(t[3]=e=>l.form.dictName=e),options:l.unitList},null,8,["onOnConfirm","modelValue","options"])):U("",!0)])),_:1})])),_:1}),x(w,{label:"基地负责人和基地状态",col:"2"},{default:p((()=>[x(E,null,{default:p((()=>[x(A,{onClick:t[4]||(t[4]=e=>s.actionJumpTo("/pages/employee/select")),placeholder:"请选择",value:l.form.manager},null,8,["value"])])),_:1}),x(E,null,{default:p((()=>[x(S,{onOnConfirm:s.statusConfirm,placeholder:"请选择",title:"基地状态",modelValue:l.form.status,"onUpdate:modelValue":t[5]||(t[5]=e=>l.form.status=e),options:["启用","停用"]},null,8,["onOnConfirm","modelValue"])])),_:1})])),_:1}),x(w,{label:"联系方式"},{default:p((()=>[x(E,null,{default:p((()=>[x(d,{modelValue:l.form.phone,"onUpdate:modelValue":t[6]||(t[6]=e=>l.form.phone=e),style:{width:"100%"},type:"text",placeholder:"请输入联系方式"},null,8,["modelValue"])])),_:1})])),_:1}),x(w,{label:"基地照片"},{default:p((()=>[x(I,null,{default:p((()=>[x(D,{ref:"myFileUploadRef",maxCount:2},null,512)])),_:1})])),_:1})])),_:1}),x(i,{class:"base-edit-footer"},{default:p((()=>[x(O,{style:{background:"#00b568",color:"#fff"},onClick:s.actionSubmit},{default:p((()=>[V("确定 ")])),_:1},8,["onClick"])])),_:1})])),_:1})}],["__scopeId","data-v-16246d14"]]);export{k as default};
