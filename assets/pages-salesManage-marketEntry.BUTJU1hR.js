import{_ as e,$ as t,Q as s,X as a,al as o,E as l,C as i,y as r,A as u,G as d,H as c,h as n,w as m,Y as f,p as _,O as p,a4 as T,g as C,i as h,l as y,t as S,I as k,k as g,r as E,F as O,q as R}from"./index-CBLTQg_b.js";import{_ as U}from"./u-datetime-picker.BDTYO2Mk.js";import{_ as I}from"./dw-cell-group.CTMyFgWA.js";import"./u-picker.BPw4DyFW.js";import"./u-loading-icon.Bdr6stTV.js";const N=e({name:"",components:{},data:()=>({isShowSaleTimePicker:!1,productList:[],customerList:{},saleTime:"",time:(new Date).getTime()}),onLoad(){t("customerSelect",(e=>{console.log(e),this.customerList=e})),t("productSelect",(e=>{console.log(e),this.productList=e}))},onUnload(){s("customerSelect"),s("productSelect")},created(){},watch:{},computed:{},methods:{formatter:(e,t)=>"year"===e?`${t}年`:"month"===e?`${t}月`:"day"===e?`${t}日`:"hour"===e?`${t}时`:"minute"===e?`${t}分`:t,back(){a()},datetimeConfirm(e){this.isShowSaleTimePicker=!1,this.saleTime=o(e.value,"yyyy-mm-dd")},actionJumpTo(e){l({url:e})},submit(){if(0==this.productList.length)return void i("请选择产品");if(console.log(this.customerList),!this.customerList.ID)return void i("请选择客户");if(!this.saleTime)return void i("请选择销售时间");let e=this.productList.map((e=>({harvestUnit:e.HARVEST_UNIT,joinFlag:e.JOIN_FLAG,mediCheck:e.MEDI_CHECK,mediResult:e.MEDI_RESULT,productAmount:e.PRODUCT_AMOUNT,productId:e.PRODUCT_ID,productIndustry:e.PRODUCT_INDUSTRY,productName:e.PRODUCT_NAME,productPc:e.PRODUCT_PC,productSort:e.PRODUCT_SORT,proofNumber:e.PROOF_NUMBER,saleAmount:e.saleAmount,saleTime:this.saleTime,shortCode:e.SHORT_CODE,sourceEntity:e.SOURCE_ENTITY,storeCount:e.STORE_COUNT,unitId:e.UNIT_ID,id:e.ID,freezeCount:e.FREEZE_COUNT})));r.post("sofn-tts-web-branch/ttsScltxxcjXsdj/addXsdjrsV2",{entityId:u("userInfo").id,customerList:JSON.stringify(this.customerList),type:"R",productList:JSON.stringify(e)},{header:{token:u("token")},toast:!1}).then((e=>{200==e.httpCode?(i("操作成功"),setTimeout((()=>{a()}),1e3)):i("操作失败")}))},doSomething(){},ajaxXxx(){}}},[["render",function(e,t,s,a,o,l){const i=d(c("u-navbar"),f),r=_,u=d(c("u-datetime-picker"),U),N=d(c("dw-icon"),p),D=R,L=d(c("dw-cell"),T),w=d(c("dw-cell-group"),I);return C(),n(r,{class:"sales"},{default:m((()=>[h(i,{title:"入市销售",autoBack:!0,placeholder:"",border:""}),h(r,{class:"sales-body"},{default:m((()=>[h(w,null,{default:m((()=>[h(L,{onClick:t[2]||(t[2]=e=>o.isShowSaleTimePicker=!0)},{extra:m((()=>[h(u,{onCancel:t[0]||(t[0]=e=>o.isShowSaleTimePicker=!1),onConfirm:l.datetimeConfirm,show:o.isShowSaleTimePicker,mode:"date",modelValue:o.time,"onUpdate:modelValue":t[1]||(t[1]=e=>o.time=e),formatter:l.formatter,"max-date":(new Date).getTime()},null,8,["onConfirm","show","modelValue","formatter","max-date"]),h(r,{style:{color:"#1ec956"}},{default:m((()=>[y(S(o.saleTime),1)])),_:1}),o.saleTime?k("",!0):(C(),n(r,{key:0},{default:m((()=>[h(N,{name:"plus",color:"#1EC956"}),h(D,{class:"ml2",style:{color:"#1ec956"}},{default:m((()=>[y("选择")])),_:1})])),_:1}))])),default:m((()=>[h(r,null,{default:m((()=>[y("销售时间")])),_:1})])),_:1}),h(L,null,{extra:m((()=>[h(r,{style:{color:"#1ec956"},onClick:t[3]||(t[3]=e=>l.actionJumpTo("/pages/customer/select"))},{default:m((()=>[h(N,{name:"plus"}),h(D,{class:"ml2"},{default:m((()=>[y("选择")])),_:1})])),_:1})])),default:m((()=>[h(r,null,{default:m((()=>[y("销售客户")])),_:1})])),_:1}),o.customerList.NAME?(C(),n(r,{key:0,style:{background:"#f3f3f5",padding:"20rpx"}},{default:m((()=>[h(r,null,{default:m((()=>[y(S(o.customerList.NAME),1)])),_:1}),h(r,{style:{color:"#6e6d6d"}},{default:m((()=>[y(S(o.customerList.USER_NAME),1)])),_:1})])),_:1})):k("",!0),h(L,null,{extra:m((()=>[h(r,{style:{color:"#1ec956"},onClick:t[4]||(t[4]=e=>l.actionJumpTo("/pages/salesManage/productSelect"))},{default:m((()=>[h(N,{name:"plus"}),h(D,{class:"ml2"},{default:m((()=>[y("选择")])),_:1})])),_:1})])),default:m((()=>[h(r,null,{default:m((()=>[y("销售产品")])),_:1})])),_:1}),(C(!0),g(O,null,E(o.productList,((e,t)=>(C(),n(r,{style:{background:"#f3f3f5",padding:"20rpx",display:"flex","align-items":"center"},key:t},{default:m((()=>[h(r,{style:{width:"50%"}},{default:m((()=>[h(r,null,{default:m((()=>[y(S(e.PRODUCT_NAME),1)])),_:2},1024),h(r,{style:{color:"#6e6d6d"},class:"u-line-1"},{default:m((()=>[y("批次:"+S(e.PRODUCT_PC),1)])),_:2},1024)])),_:2},1024),h(r,{style:{color:"#6e6d6d","margin-left":"auto"}},{default:m((()=>[y(" 销售量 "),h(D,{style:{color:"orange","font-size":"44rpx"}},{default:m((()=>[y(S(e.saleAmount),1)])),_:2},1024),y(" "+S(e.HARVEST_UNIT),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1}),h(r,{class:"sales-footer"},{default:m((()=>[h(r,{class:"sales-footer-btn",onClick:l.back},{default:m((()=>[y(" 上一步")])),_:1},8,["onClick"]),h(r,{class:"sales-footer-btn primary",onClick:l.submit},{default:m((()=>[y(" 确定")])),_:1},8,["onClick"])])),_:1})])),_:1})}],["__scopeId","data-v-889cdbce"]]);export{N as default};
