import{_ as t,v as e,al as a,ab as s,y as i,A as c,G as l,H as n,h as o,w as r,Y as d,p as u,O as f,g as m,i as h,l as b,t as p,I as g,k as _,r as y,F as I,J as k,q as w,aI as P}from"./index-BUnLS0SE.js";import{_ as T,a as x}from"./dw-steps.zu_fXxWk.js";const F=t({name:"",components:{},data:()=>({config:e,timeFormat:a,id:0,title:"map",covers:[],scale:8,info:{},baseInfo:{},timeline:[],traceInfo:{},agriProductionInfo:{}}),created(){},watch:{scale(){this.scale>18&&(this.scale=18),this.scale<5&&(this.scale=5)}},onLoad(t){this.id=t.id,this.getProductInfo()},computed:{},methods:{doSomething(){},getIcon(t){switch(console.log(t),t.substring(0,2)){case"01":return"batch_planting";case"02":return"batch_livestock";case"03":return"icon_shuichan";default:return"batch_water"}},lookImage(t,e){s({current:e,urls:t.map((t=>this.config.baseUrl+"/sofn-sys-web/sysTemplate/downPic?fileUrl="+t))})},getProductInfo(){i.post("sofn-tts-web-branch/ttsTrace/getTraceDetail",{id:this.id},{header:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",token:c("token")},toast:!1}).then((t=>{this.info=t.data,this.timeline=t.data.taskInfo.map((t=>({title:t.taskName,person:t.handlerName,date:this.timeFormat(t.operationTime,"yyyy-mm-dd hh:MM"),imgList:t.photoUrl?t.photoUrl.split(","):[]}))),this.baseInfo=t.data.baseInfo,this.traceInfo=t.data.traceInfo,this.agriProductionInfo=t.data.agriProductionInfo}))},getTimeText(){switch(this.agriProductionInfo.industryType){case"01":let t="采收时间:";return"Y"===this.traceInfo.isPick&&(t="收获时间:"),t;case"02":let e="出栏时间:";return"Y"===this.traceInfo.isPick&&(e="收获时间:"),e;case"03":let a="捕捞时间:";return"Y"===this.traceInfo.isPick&&(a="收获时间:"),a}}}},[["render",function(t,e,a,s,i,c){const F=l(n("u-navbar"),d),U=u,v=k,C=w,L=l(n("dw-icon"),f),j=P,N=l(n("dw-steps-item"),T),Y=l(n("dw-steps"),x);return m(),o(U,{class:"batch-trace"},{default:r((()=>[h(F,{title:"追溯管理详情",autoBack:!0,placeholder:"",border:""}),h(U,{class:"batch-trace-body"},{default:r((()=>[h(U,{class:"batch-trace-section"},{default:r((()=>[h(U,{class:"batch-trace-section-header"},{default:r((()=>[b("生产信息")])),_:1}),h(U,{class:"batch-trace-section-body flex"},{default:r((()=>[h(U,{class:"batch-trace-goodsicon"},{default:r((()=>[h(v,{class:"batch-trace-goodsicon-img",mode:"aspectFit",src:"../../static/images/"+c.getIcon(i.traceInfo.productType)+".png"},null,8,["src"])])),_:1}),h(U,null,{default:r((()=>[h(U,{class:"mb2 fw700"},{default:r((()=>[b(p(i.agriProductionInfo.agriProductName),1),i.agriProductionInfo.agriProductAlias?(m(),o(C,{key:0},{default:r((()=>[b("("+p(i.agriProductionInfo.agriProductAlias)+")",1)])),_:1})):g("",!0)])),_:1}),h(U,{class:"text-desc mt10 ft14"},{default:r((()=>[b("追溯码："+p(i.traceInfo.traceCode),1)])),_:1})])),_:1})])),_:1}),h(U,{class:"batch-trace-date"},{default:r((()=>[h(U,null,{default:r((()=>[b("开始时间:"+p(i.timeFormat(i.traceInfo.startTime,"yyyy-mm-dd")),1)])),_:1}),h(U,null,{default:r((()=>[b(p(c.getTimeText())+p(i.timeFormat(i.traceInfo.pickTime,"yyyy-mm-dd")),1)])),_:1})])),_:1})])),_:1}),h(U,{class:"batch-trace-section"},{default:r((()=>[h(U,{class:"batch-trace-section-header"},{default:r((()=>[b("基地信息")])),_:1}),h(U,{class:"batch-trace-section-body"},{default:r((()=>[h(U,{class:"flex pb16 items-center justify-between"},{default:r((()=>[h(U,{class:"fw700"},{default:r((()=>[b("基地名称:"+p(i.baseInfo.name),1)])),_:1}),h(U,{class:"ft14 text-desc"},{default:r((()=>[b(p("01"==i.agriProductionInfo.industryType?"种植面积":"养殖面积")+":"+p(i.baseInfo.area)+p(i.baseInfo.dictName),1)])),_:1})])),_:1}),h(U,{class:"map-btns"},{default:r((()=>[h(U,{class:"map-btns-item",onClick:e[0]||(e[0]=t=>i.scale+=1)},{default:r((()=>[h(L,{name:"plus"})])),_:1}),h(U,{class:"map-btns-item",onClick:e[1]||(e[1]=t=>i.scale-=1)},{default:r((()=>[h(L,{name:"minus"})])),_:1})])),_:1}),h(j,{style:{width:"100%",height:"360rpx"},latitude:i.baseInfo.latitude,longitude:i.baseInfo.longitude,markers:i.covers,scale:i.scale},null,8,["latitude","longitude","markers","scale"])])),_:1})])),_:1}),h(U,{class:"batch-trace-section"},{default:r((()=>[h(U,{class:"batch-trace-section-header"},{default:r((()=>[b("生产过程")])),_:1}),h(U,{class:"batch-trace-section-body"},{default:r((()=>[h(Y,null,{default:r((()=>[(m(!0),_(I,null,y(i.timeline,((t,e)=>(m(),o(N,{class:"timeline-item",date:t.date,key:e},{title:r((()=>[h(U,{class:"flex justify-between items-center"},{default:r((()=>[h(U,null,{default:r((()=>[b(p(t.title),1)])),_:2},1024),h(U,{class:"ft14 text-desc"},{default:r((()=>[b("负责人:"+p(t.person),1)])),_:2},1024)])),_:2},1024)])),default:r((()=>[h(U,null,{default:r((()=>[t.inputs?(m(),o(U,{key:0,class:"timeline-item-inputs"},{default:r((()=>[h(U,null,{default:r((()=>[b("投入品:"+p(t.inputs.name),1)])),_:2},1024),h(U,null,{default:r((()=>[b(p(t.inputs.number)+p(t.inputs.unit),1)])),_:2},1024)])),_:2},1024)):g("",!0),t.imgList?(m(),o(U,{key:1,class:"timeline-item-imgbox"},{default:r((()=>[(m(!0),_(I,null,y(t.imgList,((a,s)=>(m(),o(U,{class:"timeline-item-imgbox-img",onClick:e=>c.lookImage(t.imgList,s),key:`${e}-${s}`},{default:r((()=>[h(v,{src:i.config.baseUrl+"/sofn-sys-web/sysTemplate/downPic?fileUrl="+a,mode:"aspectFit",style:{width:"100%",height:"100%"}},null,8,["src"])])),_:2},1032,["onClick"])))),128))])),_:2},1024)):g("",!0)])),_:2},1024)])),_:2},1032,["date"])))),128))])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-cec3062a"]]);export{F as default};
