import{_ as e,v as t,V as s,y as a,A as i,W as l,x as o,X as n,C as r,S as c,G as p,H as f,h as d,w as u,p as m,Y as h,g,i as b,l as x}from"./index-CBLTQg_b.js";import{_ as L}from"./u-upload.7eQRLVwx.js";import"./u-loading-icon.Bdr6stTV.js";const w=e({name:"",components:{},data:()=>({fileList:[],formData:{textarea:""}}),onLoad(e){const{pageTitle:a,info:i}=e;this.pageTitle=a;let l=JSON.parse(decodeURIComponent(i));this.info=l,this.fileList=l.pictureUrl.split(",").map((e=>({url:t.baseUrl+"/sofn-sys-web/sysTemplate/downPic?fileUrl="+e}))),s({title:a})},watch:{},computed:{},methods:{actionSubmit(){let e=this.fileList.map((e=>e.url.replace(t.baseUrl+"/sofn-sys-web/sysTemplate/downPic?fileUrl=",""))).join(",");a.post("sofn-tts-web-branch//ttsScltxxcjEmpInfo/updateEmpInfo",{id:this.info.id,pictureUrl:e},{header:{token:i("token")},toast:!1}).then((e=>{200==e.httpCode?(l("refreshCompanyInfo"),o({icon:"none",title:"修改成功"}),n()):r(e.msg)}))},actionDelete(e){this.fileList.splice(e.index,1)},async afterRead(e){let t=[].concat(e.file),s=this.fileList.length;t.map((e=>{this.fileList.push({...e,status:"uploading",message:"上传中"})}));for(let a=0;a<t.length;a++){const e=await this.uploadFilePromise(t[a].url);let i=this.fileList[s];this.fileList.splice(s,1,{...i,status:"success",message:"",url:e}),s++}},uploadFilePromise:e=>new Promise(((s,a)=>{c({url:t.baseUrl+"/sofn-tts-web-branch/ttsScltxxcjRegiter/upload?fileapi17268223914946",filePath:e,name:"file",formData:{},success:e=>{setTimeout((()=>{let t=JSON.parse(e.data);s(t.path)}),1e3)}})})),doSomething(){},ajaxXxx(){}}},[["render",function(e,t,s,a,i,l){const o=m,n=p(f("u-navbar"),h),r=p(f("u-upload"),L);return g(),d(o,{class:"company-edit"},{default:u((()=>[b(n,{title:"企业风采",onRightClick:l.actionSubmit,autoBack:!0,placeholder:"",border:""},{right:u((()=>[b(o,{class:"u-nav-slot"},{default:u((()=>[x("确定 ")])),_:1})])),_:1},8,["onRightClick"]),b(o,{class:"pt8"}),b(r,{fileList:i.fileList,onAfterRead:l.afterRead,onDelete:l.actionDelete,name:"1",multiple:"",maxCount:5},null,8,["fileList","onAfterRead","onDelete"])])),_:1})}],["__scopeId","data-v-d057e353"]]);export{w as default};
