import{d as e,a as t,_ as o,m as l,b as a,f as s,G as n,H as i,g as d,h as r,w as c,aj as u,i as p,l as h,t as m,I as f,j as g,n as _,q as y,p as k,c as C,aM as b,ah as v,k as w,F as S,r as x,ai as I,aN as T,aO as U,x as $,y as P,A as V,W as N,X as L,Y as O,ad as R,a4 as z,M as j,K as B}from"./index-BdsNz36l.js";import{a as H,_ as A}from"./u-cell.BkABdNqp.js";import{_ as M}from"./dw-cell-group.UmTtHF6X.js";const D=o({name:"u-cell-group",mixins:[l,a,e({props:{title:{type:String,default:()=>t.cellGroup.title},border:{type:Boolean,default:()=>t.cellGroup.border}}})],methods:{addStyle:s}},[["render",function(e,t,o,l,a,s){const C=y,b=k,v=n(i("u-line"),H);return d(),r(b,{style:g([s.addStyle(e.customStyle)]),class:_([[e.customClass],"u-cell-group"])},{default:c((()=>[e.title?(d(),r(b,{key:0,class:"u-cell-group__title"},{default:c((()=>[u(e.$slots,"title",{},(()=>[p(C,{class:"u-cell-group__title__text"},{default:c((()=>[h(m(e.title),1)])),_:1})]),!0)])),_:3})):f("",!0),p(b,{class:"u-cell-group__wrapper"},{default:c((()=>[e.border?(d(),r(v,{key:0})):f("",!0),u(e.$slots,"default",{},void 0,!0)])),_:3})])),_:3},8,["style","class"])}],["__scopeId","data-v-5f6f268e"]]);const E=o({name:"u-dropdown-item",mixins:[l,a,e({props:{modelValue:{type:[Number,String,Array],default:""},title:{type:[String,Number],default:""},options:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1},height:{type:[Number,String],default:"auto"},closeOnClickOverlay:{type:Boolean,default:!0}}})],options:{styleIsolation:"shared"},data:()=>({active:!1,activeColor:"#2979ff",inactiveColor:"#606266"}),computed:{propsChange(){return`${this.title}-${this.disabled}`}},watch:{propsChange(e){this.parent&&this.parent.init()}},created(){this.parent=!1},emits:["update:modelValue","change"],methods:{addUnit:C,init(){let e=b.call(this,"u-dropdown");if(e){this.parent=e,this.activeColor=e.activeColor,this.inactiveColor=e.inactiveColor,e.children.find((e=>this===e))||e.children.push(this),1==e.children.length&&(this.active=!0),e.menuList.push({title:this.title,disabled:this.disabled})}},cellClick(e){this.$emit("update:modelValue",e),this.parent.close(),this.$emit("change",e)}},mounted(){this.init()}},[["render",function(e,t,o,l,a,s){const h=n(i("up-icon"),v),m=n(i("up-cell"),A),_=n(i("up-cell-group"),D),y=k,C=T;return a.active?(d(),r(y,{key:0,class:"u-dropdown-item",onTouchmove:I((()=>{}),["stop","prevent"]),onClick:I((()=>{}),["stop","prevent"])},{default:c((()=>[e.$slots.default||e.$slots.$default?u(e.$slots,"default",{key:1},void 0,!0):(d(),r(C,{key:0,class:"u-dropdown-item__scroll","scroll-y":"true",style:g({height:s.addUnit(e.height)})},{default:c((()=>[p(y,{class:"u-dropdown-item__options"},{default:c((()=>[p(_,null,{default:c((()=>[(d(!0),w(S,null,x(e.options,((t,o)=>(d(),r(m,{onClick:e=>s.cellClick(t.value),arrow:!1,title:t.label,key:o,"title-style":{color:e.modelValue==t.value?a.activeColor:a.inactiveColor}},{default:c((()=>[e.modelValue==t.value?(d(),r(h,{key:0,name:"checkbox-mark",color:a.activeColor,size:"32"},null,8,["color"])):f("",!0)])),_:2},1032,["onClick","title","title-style"])))),128))])),_:1})])),_:1})])),_:1},8,["style"]))])),_:3})):f("",!0)}],["__scopeId","data-v-e98efa98"]]);const F=o({name:"u-dropdown",mixins:[l,a,e({props:{activeColor:{type:String,default:"#2979ff"},inactiveColor:{type:String,default:"#606266"},closeOnClickMask:{type:Boolean,default:!0},closeOnClickSelf:{type:Boolean,default:!0},duration:{type:[Number,String],default:300},height:{type:[Number,String],default:40},borderBottom:{type:Boolean,default:!1},titleSize:{type:[Number,String],default:14},borderRadius:{type:[Number,String],default:0},menuIcon:{type:String,default:"arrow-down"},menuIconSize:{type:[Number,String],default:14}}})],data:()=>({showDropdown:!0,menuList:[],active:!1,current:99999,contentStyle:{zIndex:-1,opacity:0},highlightIndex:99999,contentHeight:0}),computed:{popupStyle(){let e={};return e.transform=`translateY(${this.active?0:"-100%"})`,e["transition-duration"]=this.duration/1e3+"s",e.borderRadius=`0 0 ${C(this.borderRadius)} ${C(this.borderRadius)}`,e}},created(){this.children=[]},mounted(){this.getContentHeight()},emits:["open","close"],methods:{addUnit:C,init(){this.menuList=[],this.children.map((e=>{e.init()}))},menuClick(e){if(!this.menuList[e].disabled)return e===this.current&&this.closeOnClickSelf?(this.close(),void setTimeout((()=>{this.children[e].active=!1}),this.duration)):void this.open(e)},open(e){this.contentHeight<1&&this.getContentHeight(),this.contentStyle={zIndex:11},this.active=!0,this.current=e,this.children.map(((t,o)=>{t.active=e==o})),this.$emit("open",this.current)},close(){this.$emit("close",this.current),this.active=!1,this.current=99999,this.contentStyle={zIndex:-1,opacity:0}},maskClick(){this.closeOnClickMask&&this.close()},highlight(e){this.highlightIndex=void 0!==e?e:99999},getContentHeight(){let e=U().windowHeight;this.$uGetRect(".u-dropdown__menu").then((t=>{this.contentHeight=e-t.bottom}))}}},[["render",function(e,t,o,l,a,s){const f=y,C=n(i("u-icon"),v),b=k;return d(),r(b,{class:"u-dropdown"},{default:c((()=>[p(b,{class:_(["u-dropdown__menu",{"u-border-bottom":e.borderBottom}]),style:g({height:s.addUnit(e.height)})},{default:c((()=>[(d(!0),w(S,null,x(a.menuList,((t,o)=>(d(),r(b,{class:"u-dropdown__menu__item",key:o,onClick:I((e=>s.menuClick(o)),["stop"])},{default:c((()=>[p(b,{class:"u-flex u-flex-row"},{default:c((()=>[p(f,{class:"u-dropdown__menu__item__text",style:g({color:t.disabled?"#c0c4cc":o===a.current||a.highlightIndex==o?e.activeColor:e.inactiveColor,fontSize:s.addUnit(e.titleSize)})},{default:c((()=>[h(m(t.title),1)])),_:2},1032,["style"]),p(b,{class:_(["u-dropdown__menu__item__arrow",{"u-dropdown__menu__item__arrow--rotate":o===a.current}])},{default:c((()=>[p(C,{"custom-style":{display:"flex"},name:e.menuIcon,size:s.addUnit(e.menuIconSize),color:o===a.current||a.highlightIndex==o?e.activeColor:"#c0c4cc"},null,8,["name","size","color"])])),_:2},1032,["class"])])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1},8,["style","class"]),p(b,{class:"u-dropdown__content",style:g([a.contentStyle,{transition:`opacity ${e.duration/1e3}s linear`,top:s.addUnit(e.height),height:a.contentHeight+"px"}]),onClick:s.maskClick,onTouchmove:t[1]||(t[1]=I((()=>{}),["stop","prevent"]))},{default:c((()=>[p(b,{onClick:t[0]||(t[0]=I((()=>{}),["stop","prevent"])),class:"u-dropdown__content__popup",style:g([s.popupStyle])},{default:c((()=>[u(e.$slots,"default",{},void 0,!0)])),_:3},8,["style"]),p(b,{class:"u-dropdown__content__mask"})])),_:3},8,["style","onClick"])])),_:3})}],["__scopeId","data-v-c2e17617"]]);const q=o({name:"",components:{},data:()=>({productId:"",slaughterProType:[],mode:"",productList:[]}),onLoad(e){const{mode:t,productId:o}=e;this.id=o,this.mode=t,this.getslaughterProType()},watch:{},computed:{},methods:{actionConfirm(){let e=this.productList.filter((e=>e.checked));if(0!=e.length)if("before"==this.mode){for(const t of e)if(!t.number)return void $({icon:"none",title:"请输入数量",duration:2e3});P.post("sofn-tts-web-branch/ttsScltxxcjScgl/isOneType",{id:e.map((e=>e.ID))},{header:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",token:V("token")},toast:!1}).then((t=>{200!==t.code?$({icon:"none",title:t.msg,duration:2e3}):(N("productSelect",e),L({delta:1}))}))}else N("afterProductSelect",e),L({delta:1});else $({icon:"none",title:"请选择屠宰产品",duration:2e3})},selectItem(e){e.checked=!e.checked},numberInput(e){console.log(e),e.PRODUCT_AMOUNT<e.number&&($({icon:"none",title:"录入数量不能大于库存数量",duration:2e3}),e.number="")},change(e){this.$refs.paging.reload()},doSomething(){},getslaughterProType(){P.post("sofn-tts-web-branch/ttsScltxxcjScgl/getslaughterProType",{userId:V("userInfo").id},{header:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",token:V("token")},toast:!1}).then((e=>{this.slaughterProType=e.map((e=>({label:e.productName,value:e.productId})))}))},queryList(e,t){if("after"==this.mode&&this.id)P.post("sofn-tts-web-branch/ttsScltxxcjProduct/getSlaProduct",{productId:this.id},{header:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",token:V("token")},toast:!1}).then((e=>{e.ttsScltxxcjProduct.forEach((e=>{e.checked=!1})),this.$refs.paging.complete(e.ttsScltxxcjProduct)}));else{let t=10*e;P.post("sofn-tts-web-branch/ttsScltxxcjScgl/getslaughterProduct",{start:t,length:10,userId:V("userInfo").id,productId:this.productId},{header:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",token:V("token")},toast:!1}).then((e=>{e.data.list.forEach((e=>{e.checked=!1})),this.$refs.paging.complete(e.data.list)}))}}}},[["render",function(e,t,o,l,a,s){const u=k,g=n(i("u-navbar"),O),_=n(i("u-dropdown-item"),E),y=n(i("up-dropdown"),F),C=n(i("u-checkbox"),R),b=B,v=n(i("dw-cell"),z),T=n(i("dw-cell-group"),M),U=n(i("z-paging"),j);return d(),r(u,{class:"processing"},{default:c((()=>[p(g,{title:"屠宰产品选择",onRightClick:s.actionConfirm,autoBack:!0,placeholder:"",border:""},{right:c((()=>[p(u,{class:"u-nav-slot"},{default:c((()=>[h(" 确定 ")])),_:1})])),_:1},8,["onRightClick"]),p(u,null,{default:c((()=>["before"===a.mode?(d(),r(y,{key:0},{default:c((()=>[p(_,{onChange:s.change,modelValue:a.productId,"onUpdate:modelValue":t[0]||(t[0]=e=>a.productId=e),title:"全部屠宰产品",options:a.slaughterProType},null,8,["onChange","modelValue","options"])])),_:1})):f("",!0)])),_:1}),p(U,{"loading-more-enabled":"before"===a.mode,"default-page-no":"0",fixed:!1,ref:"paging",modelValue:a.productList,"onUpdate:modelValue":t[2]||(t[2]=e=>a.productList=e),onQuery:s.queryList},{default:c((()=>["before"===a.mode?(d(),r(u,{key:0,class:"processing-beforelist"},{default:c((()=>[(d(!0),w(S,null,x(a.productList,((e,o)=>(d(),r(v,{onClick:t=>s.selectItem(e),key:o},{prefix:c((()=>[p(u,{style:{"pointer-events":"none"}},{default:c((()=>[p(C,{checked:e.checked,shape:"circle",activeColor:"#00B568"},null,8,["checked"])])),_:2},1024)])),default:c((()=>[p(u,{class:"processing-card"},{default:c((()=>[p(u,{class:"processing-input-group col5"},{default:c((()=>[p(u,{class:"processing-card-title"},{default:c((()=>[h(m(e.PRODUCT_NAME),1)])),_:2},1024),p(u,{class:"processing-card-input",onClick:t[1]||(t[1]=I((()=>{}),["stop"]))},{default:c((()=>[p(b,{onInput:t=>s.numberInput(e),type:"number",modelValue:e.number,"onUpdate:modelValue":t=>e.number=t,style:{"text-align":"center"}},null,8,["onInput","modelValue","onUpdate:modelValue"]),p(u,null,{default:c((()=>[h(m(e.HARVEST_UNIT),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),p(u,{class:"processing-card-code"},{default:c((()=>[h("产品追溯码:"+m(e.PRODUCT_PC),1)])),_:2},1024),p(u,{class:"processing-card-code"},{default:c((()=>[h("库　存:"+m(e.PRODUCT_AMOUNT)+m(e.HARVEST_UNIT),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):f("",!0),"after"===a.mode?(d(),r(u,{key:1,class:"processing-afterlist"},{default:c((()=>[p(T,null,{default:c((()=>[(d(!0),w(S,null,x(a.productList,((e,t)=>(d(),r(v,{onClick:t=>s.selectItem(e),key:t},{prefix:c((()=>[p(u,{style:{"pointer-events":"none"}},{default:c((()=>[p(C,{checked:e.checked,shape:"circle",activeColor:"#00B568"},null,8,["checked"])])),_:2},1024)])),default:c((()=>[p(u,null,{default:c((()=>[h(m(e.name),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})):f("",!0)])),_:1},8,["loading-more-enabled","modelValue","onQuery"])])),_:1})}],["__scopeId","data-v-a10356cc"]]);export{q as default};
